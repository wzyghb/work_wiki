
### 版本检查

```
import sqlalchemy
sqlalchemy.__version__
```

### 连接

```
from sqlalchemy import create_engine
engine = create_engine('sqlite:///:memory:', echo=True)

### 定义映射
from sqlalchemy.ext.declarative import declarative_base
Base = declarative_base()

from sqlalchemy import Column, Integer, String

class User(Base):
     __tablename__ = 'users'

     id = Column(Integer, primary_key=True)
     name = Column(String)
     fullname = Column(String)
     password = Column(String)

     def __repr__(self):
        return "<User(name='%s', fullname='%s', password='%s')>" % (
                             self.name, self.fullname, self.password)
```

### 定义范式

```
>>> User.__table__ 
Table('users', MetaData(bind=None),
            Column('id', Integer(), table=<users>, primary_key=True, nullable=False),
            Column('name', String(), table=<users>),
            Column('fullname', String(), table=<users>),
            Column('password', String(), table=<users>), schema=None)

>>> Base.metadata.create_all(engine)
SELECT ...
PRAGMA table_info("users")
()
CREATE TABLE users (
    id INTEGER NOT NULL, name VARCHAR,
    fullname VARCHAR,
    password VARCHAR,
    PRIMARY KEY (id)
)
()
COMMIT
```

### 创建Mapped Class的实例

```
ed_user = User(name='ed', fullname='Ed Jones', password='edspassword')
ed_user.name ＃ ed
```

### 创建会话Session

```
from sqlalchemy.orm import sessionmaker
Session = sessionmaker(bind=engine)

或者
Session = sessionmaker()
Session.configure(bind=engine)

最后得到可用的会话对象：
Session.configure(bind=engine)
session = Session()
```


### 加入与更新数据

```
ed_user = User(name='ed', fullname='Ed Jones', password='edspassword')
session.add(ed_user)
our_user = session.query(User).filter_by(name='ed').first()
ed_user is our_user  ＃ True

直接将一个列表加入到数据库中
>>> session.add_all([
...     User(name='wendy', fullname='Wendy Williams', password='foobar'),
...     User(name='mary', fullname='Mary Contrary', password='xxg527'),
...     User(name='fred', fullname='Fred Flinstone', password='blah')])
```

### 回滚

```
session.rollback()
fake_user in session  ＃ False
```

### 查询语句

+ order_by语句

```
for instance in session.query(User).order_by(User.id):
     print(instance.name, instance.fullname)
```

+ 有限查询

```
for name, fullname in session.query(User.name, User.fullname):
     print(name, fullname)
```

+ 元组查询

```
for row in session.query(User, User.name).all():
    print(row.User, row.name)
```

+ 

```
for row in session.query(User.name.label('name_label')).all():
    print(row.name_label)
```

+ 范围查询

```
for u in session.query(User).order_by(User.id)[1:3]:
    print(u)
```
  
+ 过滤

```
for name, in session.query(User.name).\
             filter_by(fullname='Ed Jones'):
    print(name)

for name, in session.query(User.name).\
             filter(User.fullname=='Ed Jones'):
    print(name)
```

+ 常用的过滤操作

```
equals:

not equals:

LIKE:

IN:

NOT IN:

IS NULL:

IS NOT NULL:

AND:

OR:

MATCH:
```

### 
### 